---
title: "Group 7: Covid-19 Forecast and Analysis"
author: "George Garcia, Torreon Green, Alexander Nguyen, Edgar Sosa Leal"
date: "4/18/2020"
output: powerpoint_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
library(skimr)
library(tidyverse)
library(forecast)
```

## The Data

```{r}
load(file = "coronavirus.rda")
covidData <- read.csv("C:/Users/george/Documents/R Assignments/INFS 6359 Data Mining for Business Analytics/Group-7-Covid-19-ML-Project/covid-statistics-by-us-states-daily-updates.csv", header = TRUE)
head(covidData)
```

## Compute the number of positive cases daily

```{r, echo=TRUE}
covid.diff <-covidData %>%
    group_by(state) %>%
    mutate(Diff = positive - lead(positive))

covidData.sort2 <- covid.diff %>%
   arrange(date)

covid.sort3 <- covidData.sort2 %>%
  group_by(date) %>%
  summarize(totals = sum(Diff)) 

covid.sort3
```

## U.S. Confirmed Cases

```{r, echo=TRUE}

corona <- coronavirus %>%
  filter(Country.Region == "US") %>%
  filter(type == "confirmed")

coronaCases <- corona[, c(5, 6)]

coronaTotal <- coronaCases %>%
  mutate(total = cumsum(cases))

coronaTotal

```

## Time Series Exponential Model

```{r}
coronaTrain <- coronaTotal[1:81, ]
coronaValid <- coronaTotal[82:88, ]

coronaTrainTS <- ts(coronaTrain$total,
            start = 1,
            end = 81,
            freq = 1)

coronaValidTS <- ts(coronaValid$total,
                   start = 82,
                   end = 88,
                   freq = 1)

coronaAR <- tslm(coronaTrainTS ~ trend, lambda = 0)

summary(coronaAR)
```

## Forecast: Post- April 12, 2020

```{r}
coronaPredict <- forecast(coronaAR, h = 7, level = 0)

# plot(coronaPredict, xlab = "# of Days",
#      ylab = "U.S. Total cases",
#      ylim = c(1, 1000000),
#      bty = "l")
# lines(coronaPredict$fitted, lwd = 2, col = "blue")
# lines(coronaValidTS, lwd = 2, col = "red", lty = 3)

plot(coronaTrainTS, xlab = "# of Days", 
     ylab = "U.S. Total Confirmed Cases",
     ylim = c(1, 1000000), 
     bty = "l")
lines(coronaPredict$fitted, lwd = 2, col = "blue")
lines(coronaValidTS, lwd = 2, col = "black", lty = 3)
```

